<link rel="import" href="./../components/panel-right/panel-right.html">
<link rel="import" href="./components/quota-list.html">


<dom-module id="page-quota">
	<template>
		<style is="custom-style" include="flex-style page-style">
		</style>
		<div class="container">
			<div class="content title fontRSU">
				รายการจัดสรรปีโควตา
			</div>
			<div class="content layout horizontal">
				<div class="flex-equal-justified">
					<div>
						<vaadin-combo-box label="แสดงข้อมูลรายปี" items="[[yearList]]" value="{{selectYear}}"></vaadin-combo-box>
					</div>
					<div>
						<paper-button raised class="font gl-btn-primary" on-tap="addQuota" id="addRedRegExporter">
							<iron-icon icon="add"></iron-icon> เพิ่มโควตา</paper-button>
					</div>
				</div>
			</div>
			<div class="content">
				<paper-material elevation="1">
						<quota-list></quota-list>
				</paper-material>
			</div>
			<panel-right title="การกำหนดปีโควตา">
				<template is="dom-if" if="[[rendered]]">
						<quota-manage></quota-manage>
				</template>
			</panel-right>
		</div>
	</template>
	<script>
		Polymer({
			is: 'page-quota',
			observers: ['getSelectQuotaYear(selectYear)'],
			behaviors: [nylonBehavior, ReduxBehavior, commonSystemAction, quotaAction],
			properties: {
				yearList: {
					statePath: 'commonSystem.quotaYear'
				}
			},
			nylonPageActive: function () {
				this.COMMON_QUOTA_YEAR();
				this.COMMON_TYPE_RICE();
			},
			attached: function () {
				this.layerContent = "addRedRegExporter";
				Polymer.RenderStatus.afterNextRender(this, function () {
					this.importHref(this.resolveUrl('./components/quota-manage.html'), (e) => {
						this.rendered = true;
					}, (e) => {
						console.log('error')
					});
				});
			},
			getSelectQuotaYear: function (year) {
				if (year != '') {
					this.QUOTA_GET_QUOTA_LIST(year);
				}
			},
			addQuota: function () {
				this.QUOTA_CLEAR_QUOTA_SELECT();
				this.$$('panel-right').open();
			}

		});
	</script>
</dom-module>